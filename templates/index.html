
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ë§ˆìŠ¤í„°ì‹œíŠ¸ ë°ì´í„° ì…ë ¥</title>
    <style>
        input[type=text] { width: 90px; }
        .title { font-weight: bold; padding-top: 10px; }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js">
    document.getElementById("excelFileInput").addEventListener("change", function (e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = function (evt) {
            const data = new Uint8Array(evt.target.result);
            const workbook = XLSX.read(data, { type: 'array' });
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
            for (let i = 1; i < json.length; i++) {
                const row = json[i];
                const table = document.getElementById("dataTable").getElementsByTagName("tbody")[0];
                const newRow = table.rows[0].cloneNode(true);
                const inputs = newRow.getElementsByTagName("input");
                for (let j = 0; j < inputs.length && j < row.length; j++) {
                    inputs[j].value = row[j];
                }
                table.appendChild(newRow);
            }
        };
        reader.readAsArrayBuffer(file);
    });
</script>

</head>

<body>
    <h2>ğŸ“‹ ë§ˆìŠ¤í„°ì‹œíŠ¸ ë°ì´í„° ì…ë ¥</h2>
    <form method="POST" action="/download_excel">
        <label>ì œí’ˆêµ°:
            <select name="ì œí’ˆêµ°">
                <option value="ì˜ìƒê°ì‹œ">ì˜ìƒê°ì‹œ</option>
                <option value="ì¶œì…í†µì œ">ì¶œì…í†µì œ</option>
            </select>
        </label><br><br>

        <table border="1" id="dataTable">
            <thead>
                <tr>
                    <th>êµ¬ë¶„</th><th>ê³„ì•½ì—¬ë¶€</th><th>ì‹ë³„ë²ˆí˜¸</th><th>ê³„ì•½ê¸ˆì•¡</th><th>ì œí’ˆëª¨ë¸ëª…</th><th>í’ˆëª…</th><th>ëª¨ë¸ëª…</th>
                    <th>ê·œê²©</th><th>ìˆ˜ëŸ‰</th><th>ì›ì‚°ì§€</th><th>êµ¬ì„±ì¢…ë¥˜</th><th>ì œí’ˆì›ê°€</th><th>ì›ì²œì œì¡°ì‚¬</th><th>ìˆ˜ìµë¥ </th><th>ë¹„ê³ </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" name="êµ¬ë¶„"></td>
                    <td><input type="text" name="ê³„ì•½ì—¬ë¶€"></td>
                    <td><input type="text" name="ì‹ë³„ë²ˆí˜¸"></td>
                    <td><input type="text" name="ê³„ì•½ê¸ˆì•¡"></td>
                    <td><input type="text" name="ì œí’ˆëª¨ë¸ëª…"></td>
                    <td><input type="text" name="í’ˆëª…"></td>
                    <td><input type="text" name="ëª¨ë¸ëª…"></td>
                    <td><input type="text" name="ê·œê²©"></td>
                    <td><input type="text" name="ìˆ˜ëŸ‰"></td>
                    <td><input type="text" name="ì›ì‚°ì§€"></td>
                    <td><input type="text" name="êµ¬ì„±ì¢…ë¥˜"></td>
                    <td><input type="text" name="ì œí’ˆì›ê°€"></td>
                    <td><input type="text" name="ì›ì²œì œì¡°ì‚¬"></td>
                    <td><input type="text" name="ìˆ˜ìµë¥ "></td>
                    <td><input type="text" name="ë¹„ê³ "></td>
                </tr>
            </tbody>
        </table>
        <br>
        <button type="button" onclick="addRow()">â• í–‰ ì¶”ê°€</button><br><br>

        <label class="title">ì—…ë¡œë“œ ë©”ëª¨:</label><br>
        <textarea name="ì—…ë¡œë“œë©”ëª¨" rows="4" cols="100" placeholder="ì—…ë¡œë“œì— ëŒ€í•œ ì„¤ëª… ë˜ëŠ” íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."></textarea><br><br>

        
    <label class="title">ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ:</label><br>
    <input type="file" id="excelFileInput" accept=".xlsx"><br><br>
    <input type="submit" value="ğŸ“¥ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ">

    </form>

    <script>
        function addRow() {
            const table = document.getElementById("dataTable").getElementsByTagName('tbody')[0];
            const newRow = table.rows[0].cloneNode(true);
            const inputs = newRow.getElementsByTagName("input");
            for (let i = 0; i < inputs.length; i++) inputs[i].value = "";
            table.appendChild(newRow);
        }
    
    document.getElementById("excelFileInput").addEventListener("change", function (e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = function (evt) {
            const data = new Uint8Array(evt.target.result);
            const workbook = XLSX.read(data, { type: 'array' });
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
            for (let i = 1; i < json.length; i++) {
                const row = json[i];
                const table = document.getElementById("dataTable").getElementsByTagName("tbody")[0];
                const newRow = table.rows[0].cloneNode(true);
                const inputs = newRow.getElementsByTagName("input");
                for (let j = 0; j < inputs.length && j < row.length; j++) {
                    inputs[j].value = row[j];
                }
                table.appendChild(newRow);
            }
        };
        reader.readAsArrayBuffer(file);
    });
</script>

</body>
</html>
