
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ë§ˆìŠ¤í„°ì‹œíŠ¸ ë°ì´í„° ì…ë ¥</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        input[type=text] { width: 90px; }
        .title { font-weight: bold; padding-top: 10px; }
    </style>
</head>
<body>
    <h2>ğŸ“‹ ë§ˆìŠ¤í„°ì‹œíŠ¸ ë°ì´í„° ì…ë ¥</h2>
    <form method="POST" action="/download_excel">
        <label>ì œí’ˆêµ°:
            <select name="ì œí’ˆêµ°">
                <option value="ì˜ìƒê°ì‹œ">ì˜ìƒê°ì‹œ</option>
                <option value="ì¶œì…í†µì œ">ì¶œì…í†µì œ</option>
            </select>
        </label><br><br>

        <table border="1" id="dataTable">
            <thead>
                <tr>
                    <th>êµ¬ë¶„</th><th>ê³„ì•½ì—¬ë¶€</th><th>ì‹ë³„ë²ˆí˜¸</th><th>ê³„ì•½ê¸ˆì•¡</th>
                    <th>ì œí’ˆëª¨ë¸ëª…</th><th>í’ˆëª…</th><th>ëª¨ë¸ëª…</th><th>ê·œê²©</th><th>ìˆ˜ëŸ‰</th>
                    <th>ì›ì‚°ì§€</th><th>êµ¬ì„±ì¢…ë¥˜</th><th>ì œí’ˆì›ê°€</th><th>ì›ì²œì œì¡°ì‚¬</th><th>ìˆ˜ìµë¥ </th><th>ë¹„ê³ </th>
                </tr>
            </thead>
            <tbody>
                <tr class="example-row" style="background-color: #f1f1f1;">
                    <td>ì£¼ìì¬</td><td>O</td><td>24061854</td><td>1,999,000</td>
                    <td>EX03B</td><td>ë³´ì•ˆìš©ì¹´ë©”ë¼</td><td>CRE-CW21821UR</td><td>Bullet Type, 2M, IR</td>
                    <td>1</td><td>ëŒ€í•œë¯¼êµ­</td><td>êµ¬ì„±í’ˆ</td><td>0</td><td>-</td><td>30.2</td><td>-</td>
                </tr>
                <tr>
                    <td><input name="êµ¬ë¶„"></td><td><input name="ê³„ì•½ì—¬ë¶€"></td><td><input name="ì‹ë³„ë²ˆí˜¸"></td><td><input name="ê³„ì•½ê¸ˆì•¡"></td>
                    <td><input name="ì œí’ˆëª¨ë¸ëª…"></td><td><input name="í’ˆëª…"></td><td><input name="ëª¨ë¸ëª…"></td><td><input name="ê·œê²©"></td>
                    <td><input name="ìˆ˜ëŸ‰"></td><td><input name="ì›ì‚°ì§€"></td><td><input name="êµ¬ì„±ì¢…ë¥˜"></td><td><input name="ì œí’ˆì›ê°€"></td>
                    <td><input name="ì›ì²œì œì¡°ì‚¬"></td><td><input name="ìˆ˜ìµë¥ "></td><td><input name="ë¹„ê³ "></td>
                </tr>
            </tbody>
        </table>
        <br>
        <button type="button" onclick="addRow()">â• í–‰ ì¶”ê°€</button><br><br>

        <label class="title">ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ:</label><br>
        <input type="file" id="excelFileInput" accept=".xlsx"><br><br>

        <label class="title">ì—…ë¡œë“œ ë©”ëª¨:</label><br>
        <textarea name="ì—…ë¡œë“œë©”ëª¨" rows="4" cols="100" placeholder="ì—…ë¡œë“œì— ëŒ€í•œ ì„¤ëª… ë˜ëŠ” íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."></textarea><br><br>

        <input type="submit" value="ğŸ“¥ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ">
    </form>

    <script>
        function addRow(data=[]) {
            const table = document.getElementById("dataTable").getElementsByTagName("tbody")[0];
            const row = table.rows[1].cloneNode(true);
            const inputs = row.getElementsByTagName("input");
            for (let i = 0; i < inputs.length; i++) {
                inputs[i].value = data[i] || "";
            }
            table.appendChild(row);
        }

        document.getElementById("excelFileInput").addEventListener("change", function (e) {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = function (evt) {
                const data = new Uint8Array(evt.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                for (let i = 1; i < json.length; i++) {
                    addRow(json[i]);
                }
            };
            reader.readAsArrayBuffer(file);
        });
    </script>
</body>
</html>
